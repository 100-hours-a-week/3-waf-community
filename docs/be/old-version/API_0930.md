# 카부캠 커뮤니티 REST API 문서

## 목차
- [1. 인증 (Authentication)](#1-인증-authentication)
- [2. 사용자 (Users)](#2-사용자-users)
- [3. 게시글 (Posts)](#3-게시글-posts)
- [4. 이미지 (Images)](#4-이미지-images)
- [5. 댓글 (Comments)](#5-댓글-comments)
- [6. 좋아요 (Likes)](#6-좋아요-likes)
- [7. 공통 응답 코드](#7-공통-응답-코드)

---

## 1. 인증 (Authentication)

### 1.1 로그인
사용자 로그인 후 액세스 토큰과 리프레시 토큰을 발급합니다.

**Endpoint**
```
POST /auth/login
```

**Request Body**
```json
{
    "email": "test@startupcode.kr",
    "password": "test1234"
}
```

**필수 파라미터**
- `email` (String): 사용자 이메일
- `password` (String): 비밀번호

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 200 | `login_success` | 로그인 성공 |
| 400 | `input_data_validation_failed` | 입력 데이터 검증 실패 |
| 401 | `invalid_credentials` | 잘못된 인증 정보 |
| 429 | `too_many_requests` | 요청 횟수 초과 |
| 500 | `internal_server_error` | 서버 내부 오류 |

**성공 응답 예시**
```json
{
    "message": "login_success",
    "data": {
        "access_token": "...",
        "refresh_token": "..."
    },
    "timestamp": "2025-10-01T14:30:00"
}
```

---

### 1.2 로그아웃
현재 세션을 종료하고 리프레시 토큰을 무효화합니다.

**Endpoint**
```
POST /auth/logout
```

**Request Body**
```json
{
    "refresh_token": "..."
}
```

**필수 파라미터**
- `refresh_token` (String): 리프레시 토큰

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 200 | `logout_success` | 로그아웃 성공 |
| 400 | `input_data_validation_failed` | 입력 데이터 검증 실패 |
| 401 | `invalid_refresh_token` | 유효하지 않은 리프레시 토큰 |
| 500 | `internal_server_error` | 서버 내부 오류 |

**성공 응답 예시**
```json
{
    "message": "logout_success",
    "data": null,
    "timestamp": "2025-10-01T14:30:00"
}
```

---

### 1.3 액세스 토큰 재발급
리프레시 토큰을 사용하여 새로운 액세스 토큰을 발급받습니다.

**Endpoint**
```
POST /auth/refresh_token
```

**Request Body**
```json
{
    "refresh_token": "..."
}
```

**필수 파라미터**
- `refresh_token` (String): 리프레시 토큰

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 200 | `token_refreshed` | 토큰 갱신 성공 |
| 400 | `input_data_validation_failed` | 입력 데이터 검증 실패 |
| 401 | `invalid_refresh_token` | 유효하지 않은 리프레시 토큰 |
| 429 | `too_many_requests` | 요청 횟수 초과 |
| 500 | `internal_server_error` | 서버 내부 오류 |

**성공 응답 예시**
```json
{
    "message": "token_refreshed",
    "data": {
        "access_token": "..."
    },
    "timestamp": "2025-10-01T14:30:00"
}
```

---

## 2. 사용자 (Users)

### 2.1 회원가입
새로운 사용자를 등록하고 자동으로 로그인 처리됩니다.

**Endpoint**
```
POST /users/signup
POST /users
```

**Request Body**
```json
{
    "email": "waf0124@ktb.kr",
    "password": "waf1234",
    "nickname": "waf.jung",
    "profile_image": "https://image.kr/img.jpg"
}
```

**필수 파라미터**
- `email` (String): 이메일
- `password` (String): 비밀번호
- `nickname` (String): 닉네임

**선택 파라미터**
- `profile_image` (String): 프로필 이미지 URL

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 201 | `register_success` | 회원가입 성공 |
| 400 | `input_data_validation_failed` | 입력 데이터 검증 실패 |
| 409 | `resource_already_exists` | 이메일 또는 닉네임 중복 |
| 429 | `too_many_requests` | 요청 횟수 초과 |
| 500 | `internal_server_error` | 서버 내부 오류 |

**성공 응답 예시**
```json
{
    "message": "register_success",
    "data": {
        "access_token": "...",
        "refresh_token": "..."
    },
    "timestamp": "2025-10-01T14:30:00"
}
```

**중복 오류 응답 예시**
```json
{
    "message": "resource_already_exists",
    "data": {
        "field": ["email"] // or ["nickname"]
    },
    "timestamp": "2025-10-01T14:30:00"
}
```

---

### 2.2 사용자 정보 조회
특정 사용자의 정보를 조회합니다.

**Endpoint**
```
GET /users/{userID}
```

**헤더**
- `Authorization`: Bearer {access_token}

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 200 | `get_profile_success` | 정보 조회 성공 |
| 401 | `token_not_valid` | 유효하지 않은 토큰 |
| 429 | `too_many_requests` | 요청 횟수 초과 |
| 500 | `internal_server_error` | 서버 내부 오류 |

**성공 응답 예시**
```json
{
    "message": "get_profile_success",
    "data": {
        "image": "...",
        "nickname": "...",
        "email": "..."
    },
    "timestamp": "2025-10-01T14:30:00"
}
```

---

### 2.3 사용자 정보 수정
사용자의 닉네임 또는 프로필 이미지를 수정합니다.

**Endpoint**
```
PATCH /users/{userID}
```

**헤더**
- `Authorization`: Bearer {access_token}

**Request Body**
```json
{
    "nickname": "waf",
    "profile_image": "https://image.kr/img.jpg"
}
```

**선택 파라미터**
- `nickname` (String): 새로운 닉네임
- `profile_image` (String): 새로운 프로필 이미지 URL

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 200 | `update_profile_success` | 정보 수정 성공 (수정된 정보 반환) |
| 400 | `input_data_validation_failed` | 입력 데이터 검증 실패 |
| 401 | `token_not_valid` | 유효하지 않은 토큰 |
| 409 | `resource_already_exists` | 닉네임 중복 |
| 429 | `too_many_requests` | 요청 횟수 초과 |
| 500 | `internal_server_error` | 서버 내부 오류 |

**성공 응답 예시**
```json
{
    "message": "update_profile_success",
    "data": {
        "nickname": "new_nickname",
        ...
    },
    "timestamp": "2025-10-01T14:30:00"
}
```

---

### 2.4 비밀번호 변경
사용자의 비밀번호를 변경합니다.

**Endpoint**
```
PATCH /users/{userID}/password
```

**헤더**
- `Authorization`: Bearer {access_token}

**Request Body**
```json
{
    "new_password": "1257d7io35",
    "new_password_confirm": "1257d7io35"
}
```

**필수 파라미터**
- `new_password` (String): 새 비밀번호
- `new_password_confirm` (String): 새 비밀번호 확인

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 200 | `update_password_success` | 비밀번호 변경 성공 |
| 400 | `input_data_validation_failed` | 비밀번호 정책 위반 또는 불일치 |
| 401 | `token_not_valid` | 유효하지 않은 토큰 |
| 500 | `internal_server_error` | 서버 내부 오류 |

**성공 응답 예시**
```json
{
    "message": "update_password_success",
    "data": null,
    "timestamp": "2025-10-01T14:30:00"
}
```

---

### 2.5 회원 탈퇴 (비활성화)
사용자 계정을 비활성화합니다.

**Endpoint**
```
PUT /users/{userID}
```

**헤더**
- `Authorization`: Bearer {access_token}

**Request Body**
```json
{
    "user_status": "INACTIVE"
}
```

**필수 파라미터**
- `user_status` (String): 상태 값 "INACTIVE" (DDL 기준: ACTIVE, INACTIVE, DELETED)

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 200 | `account_deactivated_success` | 계정 비활성화 성공 |
| 401 | `token_not_valid` | 유효하지 않은 토큰 |
| 500 | `internal_server_error` | 서버 내부 오류 |

**성공 응답 예시**
```json
{
    "message": "account_deactivated_success",
    "data": null,
    "timestamp": "2025-10-01T14:30:00"
}
```

---

## 3. 게시글 (Posts)

### 3.1 게시글 목록 조회
페이지네이션과 정렬 옵션을 사용하여 게시글 목록을 조회합니다.

**Endpoint**
```
GET /posts?offset=0&limit=10&sort=latest
```

**쿼리 파라미터**
- `offset` (Number): 페이지 시작 위치
- `limit` (Number): 한 페이지에 보여줄 게시글 수
- `sort` (String): 정렬 기준 (latest: 작성일자, likes: 좋아요 수)

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 200 | `get_posts_success` | 게시글 목록 조회 성공 |
| 400 | `input_data_validation_failed` | 입력 데이터 검증 실패 |
| 429 | `too_many_requests` | 요청 횟수 초과 |
| 500 | `internal_server_error` | 서버 내부 오류 |

**성공 응답 예시**
```json
{
    "message": "get_posts_success",
    "data": {
        "posts": [
            {
                "postId": 123,
                "title": "게시글 제목",
                "content": "게시글 내용 일부...",
                "createdAt": "2025-09-30T10:00:00Z",
                "updatedAt": "2025-09-30T10:00:00Z",
                "author": {
                    "userId": 1,
                    "nickname": "작성자",
                    "profileImage": "https://..."
    },
    "timestamp": "2025-10-01T14:30:00",
                "stats": {
                    "likeCount": 42,
                    "commentCount": 15,
                    "viewCount": 230
                }
            }
        ],
        "pagination": {
            "total_count": 150
        }
    }
}
```

---

### 3.2 특정 게시글 상세 조회
게시글의 상세 정보를 조회합니다. 작성자 정보 포함.

**Endpoint**
```
GET /posts/{postId}
```

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 200 | `get_post_detail_success` | 게시글 조회 성공 |
| 404 | `post_not_found` | 게시글을 찾을 수 없음 |
| 429 | `too_many_requests` | 요청 횟수 초과 |
| 500 | `internal_server_error` | 서버 내부 오류 |

**성공 응답 예시**
```json
{
    "message": "get_post_detail_success",
    "data": {
        "postId": 123,
        "title": "...",
        "content": "...",
        ...
    },
    "timestamp": "2025-10-01T14:30:00"
}
```

---

### 3.3 새 게시글 작성
새로운 게시글을 작성합니다.

**Endpoint**
```
POST /posts
```

**헤더**
- `Authorization`: Bearer {access_token}

**Request Body**
```json
{
    "title": "테스트세스트",
    "content": "제곧내",
    "image_id": 1
}
```

**필수 파라미터**
- `title` (String): 게시글 제목
- `content` (String): 게시글 내용

**선택 파라미터**
- `image_id` (Number): 이미지 ID (POST /images로 먼저 업로드 필요)

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 201 | `create_post_success` | 게시글 작성 성공 |
| 400 | `input_data_validation_failed` | 입력 데이터 검증 실패 |
| 401 | `token_not_valid` | 유효하지 않은 토큰 |
| 429 | `too_many_requests` | 요청 횟수 초과 |
| 500 | `internal_server_error` | 서버 내부 오류 |

**성공 응답 예시**
```json
{
    "message": "create_post_success",
    "data": {
        "postId": 101
    },
    "timestamp": "2025-10-01T14:30:00"
}
```

---

### 3.4 게시글 수정
기존 게시글을 수정합니다. 작성자만 가능.

**Endpoint**
```
PATCH /posts/{postId}
```

**헤더**
- `Authorization`: Bearer {access_token}

**Request Body**
```json
{
    "title": "테스트세스트",
    "content": "제곧내",
    "image_id": 1
}
```

**필수 파라미터**
- `title` (String): 게시글 제목
- `content` (String): 게시글 내용

**선택 파라미터**
- `image_id` (Number): 이미지 ID (POST /images로 먼저 업로드 필요)

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 200 | `update_post_success` | 게시글 수정 성공 (수정된 정보 반환) |
| 400 | `input_data_validation_failed` | 입력 데이터 검증 실패 |
| 401 | `token_not_valid` | 유효하지 않은 토큰 |
| 403 | `not_authorized` | 권한 없음 (작성자가 아님) |
| 404 | `post_not_found` | 게시글을 찾을 수 없음 |
| 500 | `internal_server_error` | 서버 내부 오류 |

**성공 응답 예시**
```json
{
    "message": "update_post_success",
    "data": {
        "postId": 101,
        "content": "...",
        ...
    },
    "timestamp": "2025-10-01T14:30:00"
}
```

---

### 3.5 게시글 삭제
게시글을 비활성화합니다. 작성자만 가능.

**Endpoint**
```
DELETE /posts/{postId}
PUT /posts/{postId}
```

**헤더**
- `Authorization`: Bearer {access_token}

**Request Body**
```json
{
    "post_status": "DELETED"
}
```

**필수 파라미터**
- `post_status` (String): 상태 값 "DELETED" (DDL 기준: ACTIVE, DELETED, DRAFT)

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 204 | - | 삭제 성공 (응답 body 없음) |
| 401 | `token_not_valid` | 유효하지 않은 토큰 |
| 403 | `not_authorized` | 권한 없음 (작성자가 아님) |
| 404 | `post_not_found` | 게시글을 찾을 수 없음 |
| 500 | `internal_server_error` | 서버 내부 오류 |

---

## 4. 이미지 (Images)

### 4.1 이미지 업로드
이미지를 S3에 업로드하고 이미지 ID를 반환합니다.

**Endpoint**
```
POST /images
```

**헤더**
- `Authorization`: Bearer {access_token}
- `Content-Type`: multipart/form-data

**Request Body**
- `file` (File): 업로드할 이미지 파일

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 201 | `upload_image_success` | 이미지 업로드 성공 |
| 400 | `input_data_validation_failed` | 파일 형식 또는 크기 오류 |
| 401 | `token_not_valid` | 유효하지 않은 토큰 |
| 413 | `file_too_large` | 파일 크기 초과 |
| 500 | `internal_server_error` | 서버 내부 오류 |

**성공 응답 예시**
```json
{
    "message": "upload_image_success",
    "data": {
        "image_id": 1,
        "image_url": "https://s3.amazonaws.com/bucket/images/abc123.jpg"
    },
    "timestamp": "2025-10-01T14:30:00"
}
```

**Note**:
- 지원 형식: JPG, PNG, GIF
- 최대 크기: 5MB
- 업로드된 이미지 ID는 게시글 작성/수정 시 사용

---

## 5. 댓글 (Comments)

### 댓글 객체 구조
```json
{
    "comment_id": 1234,
    "content": "좋은 글이네요!",
    "created_at": "2025-09-18T14:30:00Z",
    "updated_at": "2025-09-18T14:30:00Z",
    "author": {
        "user_id": 2,
        "nickname": "댓글댓글",
        "profile_image": "..."
    }
}
```

---

### 4.1 특정 게시글의 댓글 목록 조회
페이지네이션을 사용하여 댓글 목록을 조회합니다.

**Endpoint**
```
GET /posts/{postId}/comments?offset=0&limit=10
```

**쿼리 파라미터**
- `offset` (Number): 페이지 시작 위치
- `limit` (Number): 한 페이지에 보여줄 댓글 수

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 200 | `get_comments_success` | 댓글 목록 조회 성공 |
| 400 | `input_data_validation_failed` | 입력 데이터 검증 실패 |
| 404 | `post_not_found` | 게시글을 찾을 수 없음 |
| 500 | `internal_server_error` | 서버 내부 오류 |

**성공 응답 예시**
```json
{
    "message": "get_comments_success",
    "data": {
        "comments": [...],
        "pagination": {
            "total_count": 15
    },
    "timestamp": "2025-10-01T14:30:00"
    }
}
```

---

### 4.2 댓글 작성
특정 게시글에 댓글을 작성합니다.

**Endpoint**
```
POST /posts/{postId}/comments
```

**헤더**
- `Authorization`: Bearer {access_token}

**Request Body**
```json
{
    "comment": "...",
    "author": {...}
}
```

**필수 파라미터**
- `comment` (String): 댓글 내용 (200자 제한)

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 201 | `create_comment_success` | 댓글 작성 성공 |
| 400 | `input_data_validation_failed` | 입력 데이터 검증 실패 |
| 401 | `token_not_valid` | 유효하지 않은 토큰 |
| 404 | `post_not_found` | 게시글을 찾을 수 없음 |
| 429 | `too_many_requests` | 요청 횟수 초과 |
| 500 | `internal_server_error` | 서버 내부 오류 |

**성공 응답 예시**
```json
{
    "message": "create_comment_success",
    "data": {
        "commentId": "12345",
        "comment": "...",
        "author": "...",
        ...
    },
    "timestamp": "2025-10-01T14:30:00"
}
```

---

### 4.3 댓글 수정
본인이 작성한 댓글을 수정합니다.

**Endpoint**
```
PATCH /posts/{postId}/comments/{commentId}
```

**헤더**
- `Authorization`: Bearer {access_token}

**Request Body**
```json
{
    "comment": "..."
}
```

**필수 파라미터**
- `comment` (String): 댓글 내용 (200자 제한)

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 200 | `update_comment_success` | 댓글 수정 성공 |
| 400 | `input_data_validation_failed` | 입력 데이터 검증 실패 |
| 401 | `token_not_valid` | 유효하지 않은 토큰 |
| 403 | `not_authorized` | 권한 없음 (작성자가 아님) |
| 404 | `post_not_found` | 게시글을 찾을 수 없음 |
| 429 | `too_many_requests` | 요청 횟수 초과 |
| 500 | `internal_server_error` | 서버 내부 오류 |

**성공 응답 예시**
```json
{
    "message": "update_comment_success",
    "data": {
        "commentId": "12345",
        "comment": "...",
        "author": "...",
        ...
    },
    "timestamp": "2025-10-01T14:30:00"
}
```

---

### 4.4 댓글 삭제
본인이 작성한 댓글을 비활성화합니다. (Soft Delete)

**Endpoint**
```
PATCH /posts/{postId}/comments/{commentId}
```

**헤더**
- `Authorization`: Bearer {access_token}

**Request Body**
```json
{
    "comment_status": "DELETED"
}
```

**필수 파라미터**
- `comment_status` (String): 상태 값 "DELETED" (DDL 기준: ACTIVE, DELETED)

**Note**: 댓글 삭제는 status 변경을 통한 soft delete 방식이므로 PATCH 메서드를 사용합니다.

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 204 | - | 삭제 성공 (응답 body 없음) |
| 401 | `token_not_valid` | 유효하지 않은 토큰 |
| 403 | `not_authorized` | 권한 없음 (작성자가 아님) |
| 404 | `post_not_found` | 게시글을 찾을 수 없음 |
| 500 | `internal_server_error` | 서버 내부 오류 |

---

## 6. 좋아요 (Likes)

### 6.1 게시글 좋아요
게시글에 좋아요를 추가합니다.

**Endpoint**
```
POST /posts/{postId}/like
```

**헤더**
- `Authorization`: Bearer {access_token}

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 200 | `like_success` | 좋아요 성공 |
| 401 | `token_not_valid` | 유효하지 않은 토큰 |
| 404 | `post_not_found` | 게시글을 찾을 수 없음 |
| 409 | `already_liked` | 이미 좋아요한 게시글 |
| 429 | `too_many_requests` | 요청 횟수 초과 |
| 500 | `internal_server_error` | 서버 내부 오류 |

**성공 응답 예시**
```json
{
    "message": "like_success",
    "data": {
        "like": 10101
    },
    "timestamp": "2025-10-01T14:30:00"
}
```

---

### 6.2 게시글 좋아요 취소
게시글의 좋아요를 취소합니다.

**Endpoint**
```
DELETE /posts/{postId}/like
```

**헤더**
- `Authorization`: Bearer {access_token}

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 200 | `unlike_success` | 좋아요 취소 성공 |
| 401 | `token_not_valid` | 유효하지 않은 토큰 |
| 404 | `post_not_found` | 게시글을 찾을 수 없음 |
| 429 | `too_many_requests` | 요청 횟수 초과 |
| 500 | `internal_server_error` | 서버 내부 오류 |

**성공 응답 예시**
```json
{
    "message": "unlike_success",
    "data": {
        "like": 10100
    },
    "timestamp": "2025-10-01T14:30:00"
}
```

---

### 6.3 내가 좋아요 한 게시글 목록 조회
현재 사용자가 좋아요한 게시글 목록을 조회합니다.

**Endpoint**
```
GET /users/me/likes?offset=0&limit=10
```

**헤더**
- `Authorization`: Bearer {access_token}

**쿼리 파라미터**
- `offset` (Number): 페이지 시작 위치
- `limit` (Number): 한 페이지에 보여줄 게시글 수

**응답**

| 상태 코드 | 메시지 | 설명 |
|---------|--------|------|
| 200 | `get_liked_posts_success` | 좋아요 목록 조회 성공 |
| 400 | `input_data_validation_failed` | 입력 데이터 검증 실패 |
| 401 | `token_not_valid` | 유효하지 않은 토큰 |
| 500 | `internal_server_error` | 서버 내부 오류 |

**성공 응답 예시**
```json
{
    "message": "get_liked_posts_success",
    "data": {
        "posts": [...],
        "pagination": {
            "total_count": 45
        }
    },
    "timestamp": "2025-10-01T14:30:00"
}
```

---

## 7. 공통 응답 코드

### HTTP 상태 코드

| 코드 | 의미 | 설명 |
|-----|------|------|
| 200 | OK | 요청 성공 |
| 201 | Created | 리소스 생성 성공 |
| 204 | No Content | 성공 (응답 body 없음) |
| 400 | Bad Request | 잘못된 요청 (입력 데이터 검증 실패) |
| 401 | Unauthorized | 인증 실패 (토큰 없음/만료/무효) |
| 403 | Forbidden | 권한 없음 |
| 404 | Not Found | 리소스를 찾을 수 없음 |
| 409 | Conflict | 리소스 충돌 (중복 등) |
| 429 | Too Many Requests | 요청 횟수 초과 (Rate Limit) |
| 500 | Internal Server Error | 서버 내부 오류 |

### 공통 메시지 코드

| 메시지 | 설명 | 상태 코드 |
|--------|------|---------|
| `input_data_validation_failed` | 입력 데이터 검증 실패 | 400 |
| `token_not_valid` | 유효하지 않은 토큰 | 401 |
| `not_authorized` | 권한 없음 | 403 |
| `resource_not_found` | 리소스를 찾을 수 없음 | 404 |
| `post_not_found` | 게시글을 찾을 수 없음 | 404 |
| `resource_already_exists` | 리소스 중복 | 409 |
| `too_many_requests` | 요청 횟수 초과 | 429 |
| `internal_server_error` | 서버 내부 오류 | 500 |

---

## 부록

### 인증 헤더 형식
```
Authorization: Bearer {access_token}
```

### 페이지네이션 형식
```
?offset=0&limit=10
```
- `offset`: 시작 위치 (0부터 시작)
- `limit`: 한 번에 가져올 개수

### 응답 형식
```json
{
    "message": "작업_결과_메시지",
    "data": {
        // 응답 데이터 또는 null
    },
    "timestamp": "2025-10-01T14:30:00"
}
```